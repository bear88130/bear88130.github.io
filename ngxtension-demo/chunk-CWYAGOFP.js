import{a as we,b as Ae,c as ke}from"./chunk-TKCPNWTC.js";import"./chunk-NGJWWKOL.js";import"./chunk-ZSSD5RUB.js";import{a as be}from"./chunk-HVYJ44IC.js";import{a as Ee}from"./chunk-SHP4F2YS.js";import"./chunk-5R5WHLRE.js";import{a as ge,b as he,c as fe,d as ve,e as Ce,f as ye,g as Se,h as xe}from"./chunk-7JR3USC6.js";import{u as _e}from"./chunk-T6GQPN3G.js";import{$ as G,Ab as M,Bb as g,Da as K,F as I,Fb as ne,Ga as f,Gb as oe,Hb as ae,Kb as ce,L as B,Lb as s,Ma as Z,Mb as se,N as z,Nb as p,Ta as c,Vb as de,Z as L,ac as T,bb as E,bc as le,cb as J,cc as O,da as Q,dc as me,fa as U,fb as X,gb as v,ia as _,k as W,mb as C,nb as m,ob as w,p as h,pa as R,pb as A,qa as P,qb as ee,r as D,ra as F,rb as y,rc as pe,sa as Y,sb as te,t as j,tb as re,ub as n,uc as ue,vb as o,w as q,wb as S,x as $,xa as H,xb as k,yb as ie}from"./chunk-MFECIPXD.js";var Pe=["determinateSpinner"];function Fe(t,i){if(t&1&&(F(),n(0,"svg",11),S(1,"circle",12),o()),t&2){let e=g();C("viewBox",e._viewBox()),c(),w("stroke-dasharray",e._strokeCircumference(),"px")("stroke-dashoffset",e._strokeCircumference()/2,"px")("stroke-width",e._circleStrokeWidth(),"%"),C("r",e._circleRadius())}}var Oe=new U("mat-progress-spinner-default-options",{providedIn:"root",factory:Ve});function Ve(){return{diameter:Me}}var Me=100,Ne=10,Te=(()=>{class t{_elementRef=_(K);_noopAnimations;get color(){return this._color||this._defaultColor}set color(e){this._color=e}_color;_defaultColor="primary";_determinateCircle;constructor(){let e=_(Z,{optional:!0}),r=_(Oe);this._noopAnimations=e==="NoopAnimations"&&!!r&&!r._forceAnimations,this.mode=this._elementRef.nativeElement.nodeName.toLowerCase()==="mat-spinner"?"indeterminate":"determinate",r&&(r.color&&(this.color=this._defaultColor=r.color),r.diameter&&(this.diameter=r.diameter),r.strokeWidth&&(this.strokeWidth=r.strokeWidth))}mode;get value(){return this.mode==="determinate"?this._value:0}set value(e){this._value=Math.max(0,Math.min(100,e||0))}_value=0;get diameter(){return this._diameter}set diameter(e){this._diameter=e||0}_diameter=Me;get strokeWidth(){return this._strokeWidth??this.diameter/10}set strokeWidth(e){this._strokeWidth=e||0}_strokeWidth;_circleRadius(){return(this.diameter-Ne)/2}_viewBox(){let e=this._circleRadius()*2+this.strokeWidth;return`0 0 ${e} ${e}`}_strokeCircumference(){return 2*Math.PI*this._circleRadius()}_strokeDashOffset(){return this.mode==="determinate"?this._strokeCircumference()*(100-this._value)/100:null}_circleStrokeWidth(){return this.strokeWidth/this.diameter*100}static \u0275fac=function(r){return new(r||t)};static \u0275cmp=E({type:t,selectors:[["mat-progress-spinner"],["mat-spinner"]],viewQuery:function(r,a){if(r&1&&ne(Pe,5),r&2){let d;oe(d=ae())&&(a._determinateCircle=d.first)}},hostAttrs:["role","progressbar","tabindex","-1",1,"mat-mdc-progress-spinner","mdc-circular-progress"],hostVars:18,hostBindings:function(r,a){r&2&&(C("aria-valuemin",0)("aria-valuemax",100)("aria-valuenow",a.mode==="determinate"?a.value:null)("mode",a.mode),ee("mat-"+a.color),w("width",a.diameter,"px")("height",a.diameter,"px")("--mdc-circular-progress-size",a.diameter+"px")("--mdc-circular-progress-active-indicator-width",a.diameter+"px"),A("_mat-animation-noopable",a._noopAnimations)("mdc-circular-progress--indeterminate",a.mode==="indeterminate"))},inputs:{color:"color",mode:"mode",value:[2,"value","value",T],diameter:[2,"diameter","diameter",T],strokeWidth:[2,"strokeWidth","strokeWidth",T]},exportAs:["matProgressSpinner"],features:[X],decls:14,vars:11,consts:[["circle",""],["determinateSpinner",""],["aria-hidden","true",1,"mdc-circular-progress__determinate-container"],["xmlns","http://www.w3.org/2000/svg","focusable","false",1,"mdc-circular-progress__determinate-circle-graphic"],["cx","50%","cy","50%",1,"mdc-circular-progress__determinate-circle"],["aria-hidden","true",1,"mdc-circular-progress__indeterminate-container"],[1,"mdc-circular-progress__spinner-layer"],[1,"mdc-circular-progress__circle-clipper","mdc-circular-progress__circle-left"],[3,"ngTemplateOutlet"],[1,"mdc-circular-progress__gap-patch"],[1,"mdc-circular-progress__circle-clipper","mdc-circular-progress__circle-right"],["xmlns","http://www.w3.org/2000/svg","focusable","false",1,"mdc-circular-progress__indeterminate-circle-graphic"],["cx","50%","cy","50%"]],template:function(r,a){if(r&1&&(v(0,Fe,2,8,"ng-template",null,0,de),n(2,"div",2,1),F(),n(4,"svg",3),S(5,"circle",4),o()(),Y(),n(6,"div",5)(7,"div",6)(8,"div",7),k(9,8),o(),n(10,"div",9),k(11,8),o(),n(12,"div",10),k(13,8),o()()()),r&2){let d=ce(1);c(4),C("viewBox",a._viewBox()),c(),w("stroke-dasharray",a._strokeCircumference(),"px")("stroke-dashoffset",a._strokeDashOffset(),"px")("stroke-width",a._circleStrokeWidth(),"%"),C("r",a._circleRadius()),c(4),m("ngTemplateOutlet",d),c(2),m("ngTemplateOutlet",d),c(2),m("ngTemplateOutlet",d)}},dependencies:[pe],styles:[".mat-mdc-progress-spinner{display:block;overflow:hidden;line-height:0;position:relative;direction:ltr;transition:opacity 250ms cubic-bezier(0.4, 0, 0.6, 1)}.mat-mdc-progress-spinner circle{stroke-width:var(--mdc-circular-progress-active-indicator-width, 4px)}.mat-mdc-progress-spinner._mat-animation-noopable,.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__determinate-circle{transition:none !important}.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__indeterminate-circle-graphic,.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__spinner-layer,.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__indeterminate-container{animation:none !important}.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__indeterminate-container circle{stroke-dasharray:0 !important}@media(forced-colors: active){.mat-mdc-progress-spinner .mdc-circular-progress__indeterminate-circle-graphic,.mat-mdc-progress-spinner .mdc-circular-progress__determinate-circle{stroke:currentColor;stroke:CanvasText}}.mdc-circular-progress__determinate-container,.mdc-circular-progress__indeterminate-circle-graphic,.mdc-circular-progress__indeterminate-container,.mdc-circular-progress__spinner-layer{position:absolute;width:100%;height:100%}.mdc-circular-progress__determinate-container{transform:rotate(-90deg)}.mdc-circular-progress--indeterminate .mdc-circular-progress__determinate-container{opacity:0}.mdc-circular-progress__indeterminate-container{font-size:0;letter-spacing:0;white-space:nowrap;opacity:0}.mdc-circular-progress--indeterminate .mdc-circular-progress__indeterminate-container{opacity:1;animation:mdc-circular-progress-container-rotate 1568.2352941176ms linear infinite}.mdc-circular-progress__determinate-circle-graphic,.mdc-circular-progress__indeterminate-circle-graphic{fill:rgba(0,0,0,0)}.mat-mdc-progress-spinner .mdc-circular-progress__determinate-circle,.mat-mdc-progress-spinner .mdc-circular-progress__indeterminate-circle-graphic{stroke:var(--mdc-circular-progress-active-indicator-color, var(--mat-sys-primary))}@media(forced-colors: active){.mat-mdc-progress-spinner .mdc-circular-progress__determinate-circle,.mat-mdc-progress-spinner .mdc-circular-progress__indeterminate-circle-graphic{stroke:CanvasText}}.mdc-circular-progress__determinate-circle{transition:stroke-dashoffset 500ms cubic-bezier(0, 0, 0.2, 1)}.mdc-circular-progress__gap-patch{position:absolute;top:0;left:47.5%;box-sizing:border-box;width:5%;height:100%;overflow:hidden}.mdc-circular-progress__gap-patch .mdc-circular-progress__indeterminate-circle-graphic{left:-900%;width:2000%;transform:rotate(180deg)}.mdc-circular-progress__circle-clipper .mdc-circular-progress__indeterminate-circle-graphic{width:200%}.mdc-circular-progress__circle-right .mdc-circular-progress__indeterminate-circle-graphic{left:-100%}.mdc-circular-progress--indeterminate .mdc-circular-progress__circle-left .mdc-circular-progress__indeterminate-circle-graphic{animation:mdc-circular-progress-left-spin 1333ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--indeterminate .mdc-circular-progress__circle-right .mdc-circular-progress__indeterminate-circle-graphic{animation:mdc-circular-progress-right-spin 1333ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress__circle-clipper{display:inline-flex;position:relative;width:50%;height:100%;overflow:hidden}.mdc-circular-progress--indeterminate .mdc-circular-progress__spinner-layer{animation:mdc-circular-progress-spinner-layer-rotate 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}@keyframes mdc-circular-progress-container-rotate{to{transform:rotate(360deg)}}@keyframes mdc-circular-progress-spinner-layer-rotate{12.5%{transform:rotate(135deg)}25%{transform:rotate(270deg)}37.5%{transform:rotate(405deg)}50%{transform:rotate(540deg)}62.5%{transform:rotate(675deg)}75%{transform:rotate(810deg)}87.5%{transform:rotate(945deg)}100%{transform:rotate(1080deg)}}@keyframes mdc-circular-progress-left-spin{from{transform:rotate(265deg)}50%{transform:rotate(130deg)}to{transform:rotate(265deg)}}@keyframes mdc-circular-progress-right-spin{from{transform:rotate(-265deg)}50%{transform:rotate(-130deg)}to{transform:rotate(-265deg)}}"],encapsulation:2,changeDetection:0})}return t})();var De=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=J({type:t});static \u0275inj=Q({imports:[_e]})}return t})();function x(t,i={}){return Ee(x,i?.injector,()=>{let e=_(H),r=new W,d=$e(r,i?.behavior??"switch").subscribe({next:l=>u.set({kind:1,value:l}),error:l=>u.set({kind:2,error:l})});e.onDestroy(()=>d.unsubscribe());let u;if(i?.requireSync&&i?.initialValue===void 0){let l=t(void 0);if(Ie(l))throw new Error(je);u=f({kind:0}),D(l)?r.next(l):u.set({kind:1,value:l})}else u=f({kind:1,value:i?.initialValue});if(i?.requireSync&&u().kind===0)throw new Error(qe);let V=i?.requireSync===!0;return me(()=>{let l=O(()=>{let N=u();return N.kind===1?N.value:void 0}),b=t(l);if(V){V=!1;return}O(()=>{r.next(D(b)||Ie(b)?b:h(b))})}),le(()=>{let l=u();switch(l.kind){case 1:return l.value;case 2:throw l.error;case 0:return;default:throw new Error("Unknown state")}},{equal:i?.equal})})}var je="Promises cannot be used with requireSync. Pass an initialValue or set requireSync to false.",qe="The observable passed to derivedAsync() did not emit synchronously. Pass an initialValue or set requireSync to false.";function $e(t,i){let e={merge:q,concat:$,exhaust:z,switch:L};return t.pipe(e[i]())}function Ie(t){return t&&typeof t.then=="function"}var ze=(t,i)=>i.id;function Le(t,i){if(t&1){let e=ie();n(0,"div",14)(1,"span"),s(2),o(),n(3,"button",15),M("click",function(){let a=R(e).$implicit,d=g(2);return P(d.toggleTodo(a.id))}),s(4),o(),n(5,"button",15),M("click",function(){let a=R(e).$implicit,d=g(2);return P(d.loadTodoDetails(a.id))}),s(6," \u67E5\u770B\u8A73\u60C5 "),o()()}if(t&2){let e=i.$implicit;c(),A("line-through",e.completed),c(),se(e.title),c(2),p(" ",e.completed?"\u53D6\u6D88\u5B8C\u6210":"\u6A19\u8A18\u5B8C\u6210"," ")}}function Ge(t,i){t&1&&(n(0,"div",8),te(1,Le,7,4,"div",14,ze),o()),t&2&&(c(),re(i))}function Qe(t,i){t&1&&(n(0,"div",9),S(1,"mat-spinner",16),o())}function Ue(t,i){if(t&1&&(n(0,"div")(1,"p"),s(2),o(),n(3,"p"),s(4),o(),n(5,"p"),s(6),o()()),t&2){let e=g();c(2),p("ID: ",e.id,""),c(2),p("\u6A19\u984C: ",e.title,""),c(2),p("\u72C0\u614B: ",e.completed?"\u5DF2\u5B8C\u6210":"\u672A\u5B8C\u6210","")}}function Ye(t,i){t&1&&v(0,Ue,7,3,"div"),t&2&&y(i?0:-1)}function He(t,i){t&1&&(n(0,"div",9),S(1,"mat-spinner",16),o())}function Ke(t,i){if(t&1&&(n(0,"div",10)(1,"h3",12),s(2,"\u5F85\u8FA6\u4E8B\u9805\u8A73\u60C5"),o(),v(3,Ye,1,1)(4,He,2,0,"div",9),o()),t&2){let e,r=g();c(3),y((e=r.todoDetails())?3:4,e)}}function Ze(t,i){if(t&1&&(n(0,"div",13),s(1),o()),t&2){let e=g();c(),p(" ",e.error()," ")}}var Be=class t{dataService=_(be);selectedTodoId=f(null);currentBehavior=f("switch");error=f(null);todos=x(()=>this.dataService.getTodos().pipe(I(i=>(this.error.set("\u8F09\u5165\u5F85\u8FA6\u4E8B\u9805\u5931\u6557"),h([])))),{initialValue:[]});todoDetails=x(()=>{let i=this.selectedTodoId();return i?this.dataService.getTodoById(i).pipe(B(2e3),j(e=>e||null),G(()=>{console.log("getTodoById",i)}),I(e=>(this.error.set("\u8F09\u5165\u8A73\u60C5\u5931\u6557"),h(null)))):h(null)},{behavior:this.currentBehavior(),initialValue:null});stats=x(()=>{let i=this.todos(),e=i.length,r=i.filter(d=>d.completed).length,a=e===0?0:Math.round(r/e*100);return h({total:e,completed:r,completionRate:a}).pipe(B(500))},{initialValue:{total:0,completed:0,completionRate:0},requireSync:!0});updateBehavior(i){this.currentBehavior.set(i.value),this.error.set(null)}loadTodoDetails(i){this.selectedTodoId.set(i),this.error.set(null)}toggleTodo(i){this.dataService.toggleTodo(i).subscribe({next:()=>{this.todos=x(()=>this.dataService.getTodos(),{initialValue:this.todos()}),this.selectedTodoId()===i&&this.loadTodoDetails(i)},error:()=>{this.error.set("\u66F4\u65B0\u5F85\u8FA6\u4E8B\u9805\u5931\u6557")}})}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=E({type:t,selectors:[["app-derived-async"]],decls:30,vars:11,consts:[[1,"max-w-2xl","mx-auto"],[1,"p-4"],[1,"mb-4"],[3,"change","multiple"],["value","switch",3,"selected"],["value","merge",3,"selected"],["value","concat",3,"selected"],["value","exhaust",3,"selected"],[1,"space-y-2"],[1,"flex","justify-center"],[1,"mt-4","p-4","border","rounded"],[1,"mt-4","p-4","bg-gray-100","rounded"],[1,"text-lg","font-bold","mb-2"],[1,"mt-4","p-4","bg-red-100","text-red-700","rounded"],[1,"flex","items-center","gap-2","p-2","border","rounded"],["mat-button","",3,"click"],["diameter","30"]],template:function(e,r){if(e&1&&(n(0,"mat-card",0)(1,"mat-card-header")(2,"mat-card-title"),s(3,"Derived Async Signal Demo"),o(),n(4,"mat-card-subtitle"),s(5," \u5C55\u793A\u5982\u4F55\u4F7F\u7528 derivedAsync \u8655\u7406\u975E\u540C\u6B65\u6578\u64DA\uFF0C\u5305\u542B\u4E0D\u540C\u7684\u884C\u70BA\u6A21\u5F0F\u548C\u932F\u8AA4\u8655\u7406 "),o()(),n(6,"mat-card-content",1)(7,"div",2)(8,"mat-chip-listbox",3),M("change",function(d){return r.updateBehavior(d)}),n(9,"mat-chip-option",4),s(10," Switch Mode "),o(),n(11,"mat-chip-option",5),s(12," Merge Mode "),o(),n(13,"mat-chip-option",6),s(14," Concat Mode "),o(),n(15,"mat-chip-option",7),s(16," Exhaust Mode "),o()()(),v(17,Ge,3,0,"div",8)(18,Qe,2,0,"div",9)(19,Ke,5,1,"div",10),n(20,"div",11)(21,"h3",12),s(22,"\u7D71\u8A08\u8CC7\u8A0A"),o(),n(23,"p"),s(24),o(),n(25,"p"),s(26),o(),n(27,"p"),s(28),o()(),v(29,Ze,2,1,"div",13),o()()),e&2){let a;c(8),m("multiple",!1),c(),m("selected",r.currentBehavior()==="switch"),c(2),m("selected",r.currentBehavior()==="merge"),c(2),m("selected",r.currentBehavior()==="concat"),c(2),m("selected",r.currentBehavior()==="exhaust"),c(2),y((a=r.todos())?17:18,a),c(2),y(r.selectedTodoId()?19:-1),c(5),p("\u7E3D\u6578: ",r.stats().total,""),c(2),p("\u5DF2\u5B8C\u6210: ",r.stats().completed,""),c(2),p("\u5B8C\u6210\u7387: ",r.stats().completionRate,"%"),c(),y(r.error()?29:-1)}},dependencies:[ue,ye,ge,fe,Ce,ve,he,xe,Se,De,Te,ke,Ae,we],encapsulation:2})};export{Be as DerivedAsyncComponent};
