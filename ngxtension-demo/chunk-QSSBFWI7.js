import{a as ue,b as me,c as fe}from"./chunk-TKCPNWTC.js";import"./chunk-NGJWWKOL.js";import"./chunk-ZSSD5RUB.js";import{a as de}from"./chunk-HVYJ44IC.js";import{a as E}from"./chunk-N7LW4KDJ.js";import{a as $,b as F}from"./chunk-S4OXUUVE.js";import"./chunk-SHP4F2YS.js";import"./chunk-5R5WHLRE.js";import{a as oe,b as ne,c as ae,d as re,e as le,f as ce,g as se,h as pe}from"./chunk-7JR3USC6.js";import"./chunk-T6GQPN3G.js";import{Ab as O,Bb as w,Ga as x,J as B,Lb as m,Mb as Y,Nb as Z,Ob as ee,Ta as u,U as A,X as N,Xa as V,Y as g,bb as W,bc as P,dc as te,gb as q,ia as D,k as R,nb as C,pa as z,pb as G,qa as L,r as y,rb as J,sb as K,tb as Q,ub as s,uc as ie,va as H,vb as p,xa as U,yb as X}from"./chunk-MFECIPXD.js";function Se(){let o=x(0);return{notify:()=>{o.update(n=>(n>>>0)+1)},listen:o.asReadonly()}}function be(o){let n=D(U),e=D(H),{initialState:i,sources:t=[],lazySources:r=[],actionSources:_={},selectors:v=()=>({}),effects:b=()=>({})}=o,f=x(i),l=f.asReadonly(),S=F(f),j=!1,T=[],h=l;for(let[a,c]of Object.entries(_))if(y(c))ge(l,S,a,n,c,T);else{let d=new R,I=c(l,d).pipe(A());E(f,I),ge(l,S,a,n,d,T,I)}for(let a in i){let c=P(()=>l()[a]);Object.defineProperty(l,a,{value:c}),l[`${a}$`]=F(c)}for(let[a,c]of Object.entries(v(h))){let d=P(c);Object.defineProperty(l,a,{value:d}),l[`${a}$`]=F(d)}for(let[a,c]of Object.entries(b(h)))console.warn("The 'effects' configuration in signalSlice is deprecated. Please use standard signal effects outside of signalSlice instead."),Object.defineProperty(h,a,{value:te(d=>{let M=c();M&&d(()=>M())})});ve(f,t,l),n.onDestroy(()=>{T.forEach(a=>a.complete())});let k=()=>{j||(j=!0,ve(f,r,l,e,!0))};return new Proxy(h,{get(a,c,d){return k(),Reflect.get(a,c,d)},apply(a,c,d){return k(),Reflect.apply(a,c,d)}})}function ve(o,n,e,i,t=!1){for(let r of n)y(r)?E(o,r,i,t):E(o,r(e),i,t)}function ge(o,n,e,i,t,r,_){let v=Se();Object.defineProperties(o,{[e]:{value:b=>y(b)?new Promise((f,l)=>{b.pipe($(i)).subscribe({next:S=>{v.notify(),t.next(S)},error:S=>{t.error(S),l(S)},complete:()=>{v.notify(),t.complete(),f(o())}})}):(_&&_.pipe($(i)).subscribe(),new Promise(f=>{n.pipe(B(1)).subscribe(l=>{f(l)}),v.notify(),t.next(b)}))},[`${e}$`]:{value:t.asObservable()},[`${e}Updated`]:{value:v.listen}}),r.push(t)}var _e=(o,n)=>n.id;function he(o,n){if(o&1){let e=X();s(0,"div",9)(1,"span"),m(2),p(),s(3,"button",10),O("click",function(){let t=z(e).$implicit,r=w(2);return L(r.state.toggleTodo(t.id))}),m(4),p()()}if(o&2){let e=n.$implicit;u(),G("line-through",e.completed),u(),Y(e.title),u(2),Z(" ",e.completed?"\u53D6\u6D88\u5B8C\u6210":"\u6A19\u8A18\u5B8C\u6210"," ")}}function ye(o,n){if(o&1&&(s(0,"div",8),K(1,he,5,4,"div",9,_e),p()),o&2){let e=w();u(),Q(e.state.filteredTodos())}}function xe(o,n){o&1&&(s(0,"p"),m(1,"\u8F09\u5165\u4E2D..."),p())}var Ce=class o{constructor(n){this.dataService=n;this.state=be({initialState:this.initialState,sources:[this.dataService.getTodos().pipe(N([]),g(e=>[{todos:e}]))],actionSources:{updateFilter:(e,i)=>i.pipe(g(t=>[{currentFilter:t}])),toggleTodo:(e,i)=>i.pipe(g(t=>this.dataService.toggleTodo(t)),g(()=>this.dataService.getTodos()),g(t=>[{todos:t}]))},selectors:e=>({filteredTodos:()=>{let i=e().currentFilter,t=e().todos;switch(i){case"active":return t.filter(r=>!r.completed);case"completed":return t.filter(r=>r.completed);default:return t}}})})}initialState={todos:[],currentFilter:"all"};state;static \u0275fac=function(e){return new(e||o)(V(de))};static \u0275cmp=W({type:o,selectors:[["app-signal-slice"]],decls:20,vars:7,consts:[[1,"max-w-2xl","mx-auto"],[1,"p-4"],[1,"mb-4","space-x-2"],[3,"change","multiple"],["value","all",3,"selected"],["value","active",3,"selected"],["value","completed",3,"selected"],[1,"mb-4","p-4","bg-gray-100","rounded"],[1,"space-y-2"],[1,"flex","items-center","gap-2","p-2","border","rounded"],["mat-button","",3,"click"]],template:function(e,i){e&1&&(s(0,"mat-card",0)(1,"mat-card-header")(2,"mat-card-title"),m(3,"Signal Slice Demo"),p(),s(4,"mat-card-subtitle"),m(5," \u5C55\u793A\u5982\u4F55\u4F7F\u7528 signalSlice \u9032\u884C\u8CC7\u6599\u5207\u7247\u548C\u904E\u6FFE\u64CD\u4F5C "),p()(),s(6,"mat-card-content",1)(7,"div",2)(8,"mat-chip-listbox",3),O("change",function(r){return i.state.updateFilter(r.value)}),s(9,"mat-chip-option",4),m(10," \u5168\u90E8 "),p(),s(11,"mat-chip-option",5),m(12," \u9032\u884C\u4E2D "),p(),s(13,"mat-chip-option",6),m(14," \u5DF2\u5B8C\u6210 "),p()()(),s(15,"div",7)(16,"p"),m(17),p()(),q(18,ye,3,0,"div",8)(19,xe,2,0,"p"),p()()),e&2&&(u(8),C("multiple",!1),u(),C("selected",i.state.currentFilter()==="all"),u(2),C("selected",i.state.currentFilter()==="active"),u(2),C("selected",i.state.currentFilter()==="completed"),u(4),ee(" \u986F\u793A\u4E2D\u9805\u76EE\uFF1A",i.state.filteredTodos().length," / ",i.state.todos().length," "),u(),J(i.state.todos()?18:19))},dependencies:[ie,ce,oe,ae,le,re,ne,pe,se,fe,me,ue],encapsulation:2})};export{Ce as SignalSliceComponent};
